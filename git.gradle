/*
 * Copyright (c) 2016. Fengguo Wei and others.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Detailed contributors are listed in the CONTRIBUTOR.md
 */

release {
    grgit = Grgit.open(project.rootDir)
    defaultVersionStrategy = Strategies.SNAPSHOT
}

tasks.release.dependsOn ':publishing'

ext {
    def grgit = Grgit.open(project.rootDir)

    revision = grgit.head().id
    shortMessage = grgit.head().shortMessage
}

ext.yourTag = "v${project.version.toString().replace("-SNAPSHOT", "")}"

task createTag(type: GitTag) {
    repoPath = rootDir
    tagName = yourTag
    message = "Application release $yourTag"
}

task pushTag(type: GitPush, dependsOn: createTag) {
    namesOrSpecs = [yourTag]
}